(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{365:function(e,a,t){e.exports=t.p+"assets/img/jaeger_test.f5a8b859.png"},391:function(e,a,t){"use strict";t.r(a);var s=t(8),r=Object(s.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"lab-1-installing-jaeger"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lab-1-installing-jaeger"}},[e._v("#")]),e._v(" Lab 1 - Installing Jaeger")]),e._v(" "),s("p",[e._v("The first laboratory of the workshop consist of launching a Kubernetes cluster in our local machine and install the "),s("a",{attrs:{href:"https://github.com/jaegertracing/jaeger-operator",target:"_blank",rel:"noopener noreferrer"}},[e._v("Jaeger Operator"),s("OutboundLink")],1),e._v(". In order to achieve that, we will use "),s("a",{attrs:{href:"https://kubernetes.io/docs/tutorials/hello-minikube/",target:"_blank",rel:"noopener noreferrer"}},[e._v("minikube"),s("OutboundLink")],1),e._v(" that eases a lot this task.")]),e._v(" "),s("p",[e._v("We will perform the following tasks:")]),e._v(" "),s("ol",[s("li",[e._v("Install and run a Minikube cluster in your laptop.")]),e._v(" "),s("li",[e._v("Use "),s("code",[e._v("kubectl")]),e._v(" while deploying a sample application.")]),e._v(" "),s("li",[e._v("Deploy Jaeger.")]),e._v(" "),s("li",[e._v("Test Jaeger accessing its UI.")])]),e._v(" "),s("h3",{attrs:{id:"requirements"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#requirements"}},[e._v("#")]),e._v(" Requirements")]),e._v(" "),s("ul",[s("li",[e._v("2 CPUs or more")]),e._v(" "),s("li",[e._v("8GB of free memory")]),e._v(" "),s("li",[e._v("40GB of free disk space")]),e._v(" "),s("li",[e._v("Internet connection")]),e._v(" "),s("li",[e._v("Container or virtual machine manager, such as: "),s("a",{attrs:{href:"https://docs.docker.com/engine/install/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker"),s("OutboundLink")],1),e._v(".")])]),e._v(" "),s("h2",{attrs:{id:"_1-installing-minikube"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-installing-minikube"}},[e._v("#")]),e._v(" 1. Installing Minikube")]),e._v(" "),s("p",[e._v("Depending of your OS, you will have different options for installing Minikube.")]),e._v(" "),s("Tabs",{attrs:{type:"border-card"}},[s("Tab",{attrs:{label:"Linux"}},[s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("mv")]),e._v(" minikube-linux-amd64 /usr/local/bin/minikube\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("chmod")]),e._v(" a+x /usr/local/bin/minikube\n")])])])]),e._v(" "),s("Tab",{attrs:{label:"MacOs"}},[s("p",[e._v("If the "),s("a",{attrs:{href:"https://brew.sh/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Brew Package Manager"),s("OutboundLink")],1),e._v(" installed:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("brew "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" minikube\n")])])]),s("p",[e._v("If "),s("code",[e._v("which minikube")]),e._v(" fails after installation via brew, you may have to remove the minikube cask and link the binary:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("brew cask remove minikube\nbrew "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("link")]),e._v(" minikube\n")])])]),s("p",[e._v("Otherwise, download minikube directly:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -LO https://storage.googleapis.com/minikube/releases/latest/minikube-darwin-amd64\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" minikube-darwin-amd64 /usr/local/bin/minikube\n")])])])]),e._v(" "),s("Tab",{attrs:{label:"Windows"}},[s("p",[e._v("If the "),s("a",{attrs:{href:"https://chocolatey.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Chocolatey Package Manager"),s("OutboundLink")],1),e._v(" is installed, use it to install minikube:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("choco "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" minikube\n")])])]),s("p",[e._v("Otherwise, download and run the "),s("a",{attrs:{href:"https://storage.googleapis.com/minikube/releases/latest/minikube-installer.exe",target:"_blank",rel:"noopener noreferrer"}},[e._v("Windows installer"),s("OutboundLink")],1)])])],1),e._v(" "),s("h2",{attrs:{id:"_2-starting-the-cluster"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-starting-the-cluster"}},[e._v("#")]),e._v(" 2. Starting the cluster")]),e._v(" "),s("p",[e._v("From a terminal with administrator access (but not logged in as root), run:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("minikube start --cpus "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v(" --memory "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("8192")]),e._v(" --disk-size 40g --addons"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("ingress\n")])])]),s("h2",{attrs:{id:"_3-interacting-with-k8s"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-interacting-with-k8s"}},[e._v("#")]),e._v(" 3. Interacting with K8s")]),e._v(" "),s("p",[e._v("If you already have kubectl installed, you can now use it to access your shiny new cluster:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("kubectl config use-context minikube\nkubectl get po -A\n")])])]),s("p",[e._v("Alternatively, minikube can download the appropriate version of kubectl, if you don't mind to use an alias in the command-line:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("alias")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("kubectl")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"minikube kubectl --"')]),e._v("\nkubectl get po -A\n")])])]),s("p",[e._v("minikube bundles the Kubernetes Dashboard, allowing you to get easily acclimated to your new environment:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("minikube dashboard\n")])])]),s("h2",{attrs:{id:"_4-deploying-a-sample-application"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-deploying-a-sample-application"}},[e._v("#")]),e._v(" 4. Deploying a sample application")]),e._v(" "),s("p",[e._v("Create a sample deployment and expose it on port 8080:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("kubectl create deployment hello-minikube --image"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("k8s.gcr.io/echoserver:1.4\nkubectl expose deployment hello-minikube --type"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("NodePort --port"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("8080")]),e._v("\n")])])]),s("p",[e._v("It may take a moment, but your deployment will soon show up when you run:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("kubectl get services hello-minikube\n")])])]),s("p",[e._v("The easiest way to access this service is to let minikube launch a web browser for you:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("minikube "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("service")]),e._v(" hello-minikube\n")])])]),s("p",[e._v("Alternatively, use kubectl to forward the port:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("kubectl port-forward service/hello-minikube "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("7080")]),e._v(":8080\n")])])]),s("p",[e._v("Now, the application is available at "),s("a",{attrs:{href:"http://localhost:7080/",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://localhost:7080/"),s("OutboundLink")],1)]),e._v(" "),s("h2",{attrs:{id:"_5-deleting-minikube-cluster"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-deleting-minikube-cluster"}},[e._v("#")]),e._v(" 5. Deleting minikube cluster")]),e._v(" "),s("blockquote",[s("p",[e._v("For now, we will not execute this command.")])]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("minikube delete --all\n")])])]),s("h2",{attrs:{id:"_6-deploying-jaeger-operator"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-deploying-jaeger-operator"}},[e._v("#")]),e._v(" 6. Deploying Jaeger Operator")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("kubectl create namespace observability\nkubectl create -f https://raw.githubusercontent.com/jaegertracing/jaeger-operator/master/deploy/crds/jaegertracing.io_jaegers_crd.yaml\nkubectl create -n observability -f https://raw.githubusercontent.com/jaegertracing/jaeger-operator/master/deploy/service_account.yaml\nkubectl create -n observability -f https://raw.githubusercontent.com/jaegertracing/jaeger-operator/master/deploy/role.yaml\nkubectl create -n observability -f https://raw.githubusercontent.com/jaegertracing/jaeger-operator/master/deploy/role_binding.yaml\nkubectl create -n observability -f https://raw.githubusercontent.com/jaegertracing/jaeger-operator/master/deploy/operator.yaml\n\nkubectl create -f https://raw.githubusercontent.com/jaegertracing/jaeger-operator/master/deploy/cluster_role.yaml\nkubectl create -f https://raw.githubusercontent.com/jaegertracing/jaeger-operator/master/deploy/cluster_role_binding.yaml\n")])])]),s("h2",{attrs:{id:"_7-deploying-jaeger-instance"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-deploying-jaeger-instance"}},[e._v("#")]),e._v(" 7. Deploying Jaeger instance")]),e._v(" "),s("p",[e._v("Now, we will deploy a in-memory all-in-one instance of Jaeger, suitable for this workshop.")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("Deploy the instance:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("kubectl apply -n observability -f - "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('EOF\napiVersion: jaegertracing.io/v1\nkind: Jaeger\nmetadata:\n    name: "jaeger-workshop"\nEOF')]),e._v("\n")])])])]),e._v(" "),s("li",[s("p",[e._v("Check the instance:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("kubectl get jaegers -n observability\nkubectl get pods -n observability -l app.kubernetes.io/instance"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("jaeger-workshop\n\n")])])])])]),e._v(" "),s("h2",{attrs:{id:"_8-validating-jaeger-deployment"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-validating-jaeger-deployment"}},[e._v("#")]),e._v(" 8. Validating Jaeger deployment")]),e._v(" "),s("p",[e._v("To validate that Jaeger is working correctly, let’s forward its port and see if we can access the UI:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("kubectl get -n observability ingress\n\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("K8S_INGRESS_IP")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),e._v("kubectl get -n observability ingress -o "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("jsonpath")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'{.items[0].status.loadBalancer.ingress[0].ip}'")]),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"http://'),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$K8S_INGRESS_IP")]),e._v('"')]),e._v("\n")])])]),s("p",[e._v("Now, the application is available at the link printed before.")]),e._v(" "),s("p",[s("img",{attrs:{src:t(365),alt:"Jaeger UI"}})])],1)}),[],!1,null,null,null);a.default=r.exports}}]);